# 20221109 e-AR设备数据采集指南
Data acquisition system for e-AR sensor
It is based on Chrome.

This program is mainly forked from https://github.com/bennyplo/HTML5-BLE-eAR and contributed by Yao Guo and Zhenye Xu for its data saving function and user interface.


# 一、设备概要

本设备由佩戴在人耳上的【IMU传感器主机】与【充电底座】组成。使用时，主机通过蓝牙与笔记本电脑中的数据采集系统相连接，完成数据采集。

![e-AR数据采集设备实物图。左侧为主机，右侧为充电底座](20221109%20e-AR%E8%AE%BE%E5%A4%87%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%E6%8C%87%E5%8D%97%2012f753cad0664d79af0a7a43b7167caf/Untitled.jpeg)

e-AR数据采集设备实物图。左侧为主机，右侧为充电底座

![e-AR主机佩戴方式（左右耳均可）](20221109%20e-AR%E8%AE%BE%E5%A4%87%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%E6%8C%87%E5%8D%97%2012f753cad0664d79af0a7a43b7167caf/Untitled.png)

e-AR主机佩戴方式（左右耳均可）

- 关于电量问题：一般而言，主机具有较长的工作时间，但仍推荐在闲置时将主机放在充电底座上进行充电。充电底座在连接主机正常充电的状态下会有蓝色灯光长亮，若底座灯光未亮起，可能是因为接触不良，需要进行手动的位置调整。

本设备的数据采集系统依赖于Chrome浏览器工作，请务必确认采集所用的笔记本电脑**已经安装好最新版本的Chrome浏览器，且支持蓝牙4.0连接。**数据采集系统可以从以下链接获取：

[eAR数据采集系统.zip](20221109%20e-AR%E8%AE%BE%E5%A4%87%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%E6%8C%87%E5%8D%97%2012f753cad0664d79af0a7a43b7167caf/eAR%25E6%2595%25B0%25E6%258D%25AE%25E9%2587%2587%25E9%259B%2586%25E7%25B3%25BB%25E7%25BB%259F.zip)

# 二、数据采集方法

本部分的主要内容为说明如何使用e-AR设备采集一段患者的步态数据并保存为csv文件。

1. **主机开机：**轻按**主机外侧透明部位内侧贴有铜片处**，直至所按部位发出蓝光为止。
    - 一般而言，在一段时间没有进行连接后，主机会自动关机，需要再次轻按开启。
    
    ![开机动作示意图](20221109%20e-AR%E8%AE%BE%E5%A4%87%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%E6%8C%87%E5%8D%97%2012f753cad0664d79af0a7a43b7167caf/Untitled%201.jpeg)
    
    开机动作示意图
    
2. 打开数据采集系统：下载eAR数据采集系统并解压，使用Chrome浏览器打开文件夹中的index.html文件，进入以下页面：
    
    ![启动页面](20221109%20e-AR%E8%AE%BE%E5%A4%87%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%E6%8C%87%E5%8D%97%2012f753cad0664d79af0a7a43b7167caf/Untitled%201.png)
    
    启动页面
    
3. 蓝牙连接主机：点击【开启蓝牙连接】，浏览器会自动弹出一个蓝牙设备连接窗口，选中蓝牙设备列表中的【e-AR2016】设备，并点击【配对】
    - 注意：若同时有多个e-AR主机处于开启状态，需要通过设备后的MAC地址（形如F5:DE:62:B0:64:8F）来判断所连接的具体是哪个设备。但一般不推荐多台设备同时连接。
    - 注意：由于蓝牙连接信号不稳，需要采集者**携带笔记本电脑紧跟患者**进行数据的采集和记录。若中途信号断联会使得信号无法正常记录。
    
    ![蓝牙连接窗口](20221109%20e-AR%E8%AE%BE%E5%A4%87%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%E6%8C%87%E5%8D%97%2012f753cad0664d79af0a7a43b7167caf/Untitled%202.png)
    
    蓝牙连接窗口
    
4. 患者信息录入：连接成功后，系统会自动跳转到数据采集页面，实时显示当前主机返回的数据。而在正式开始记录之前，首先要进行患者基本信息的录入。要录入的患者信息及录入格式如下：
    - 患者ID：四位数字，用做患者的唯一标识符
    - 患者年龄：两位数字，记录患者的年龄
    - 患者性别：一位字母（M/F），记录患者的性别
    - 患者身高：三位数字（cm），记录患者的身高
    - 患者体重：三位数字（kg），记录患者的体重
    - 佩戴方式：一位字母（L/R），记录在本次测试中传感器佩戴在患者的哪一侧耳朵
    
    ![数据采集页面](20221109%20e-AR%E8%AE%BE%E5%A4%87%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%E6%8C%87%E5%8D%97%2012f753cad0664d79af0a7a43b7167caf/Untitled%203.png)
    
    数据采集页面
    
5. 记录数据：在完成信息录入后，请让患者做好开始实验的准备，确认后请按下【开始记录数据】，并让患者【完成一次较为明显的点头动作】，完成后开始按照实验项目预定的内容进行实验。在完成一次项目后，请点击【停止记录数据】来完成记录并将数据保存为csv文件。该csv文件默认保存在Chrome的默认下载文件夹中。
